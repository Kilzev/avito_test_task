БАГИ ЗАДАНИЯ №2.1

Кейс_1 — Некорректное сообщение об ошибке при передаче невалидного типа sellerId

Приоритет: Medium

Описание

При передаче значения неверного типа в поле sellerId (строка вместо числа) сервер возвращает сообщение, не соответствующее причине ошибки.

Шаги воспроизведения

1. Отправить POST /api/1/item с телом:

{
  "sellerId": "abc",
  "name": "Test item",
  "price": 100,
  "statistics": {
    "likes": 1,
    "viewCount": 1,
    "contacts": 1
  }
}

Фактический результат

HTTP 400
Ответ:

{
  "result": {
    "message": "",
    "messages": {}
  },
  "status": "не передано тело объявления"
}

Ожидаемый результат

Ответ должен содержать информативное сообщение о причине ошибки, например:

«Поле sellerId должно быть числом»


Обоснование приоритета

Сообщение не отражает реальную причину ошибки, что усложняет отладку и использование API.




Кейс_2 — Значение 0 в полях статистики считается отсутствующим

Приоритет: High

Описание

При передаче значения 0 в полях likes, viewCount, contacts API возвращает ошибку валидации, как будто поле отсутствует.

Шаги воспроизведения

1. Отправить POST /api/1/item с телом:

{
  "sellerId": 123456,
  "name": "Test item",
  "price": 100,
  "statistics": {
    "likes": 0,
    "viewCount": 0,
    "contacts": 0
  }
}

Фактический результат

HTTP 400

{
  "result": {
    "message": "поле likes обязательно",
    "messages": {}
  },
  "status": "400"
}

Ожидаемый результат

Значения 0 должны считаться валидными, так как являются допустимыми начальными значениями счётчиков.

Ожидаемый успешный ответ:

{
  "status": "Сохранили объявление - <UUID объявления>"
}

Обоснование приоритета

Ошибка блокирует создание объявления с корректными начальными значениями статистики и нарушает бизнес-логику сервиса.



Кейс_3 — Некорректная обработка отрицательной цены

Приоритет: High

Описание

При передаче отрицательного значения в поле price API возвращает ошибку валидации, как будто поле отсутствует.

Шаги воспроизведения

1. Отправить POST /api/1/item с телом:

{
  "sellerId": 123456,
  "name": "Test item",
  "price": -100,
  "statistics": {
    "likes": 1,
    "viewCount": 1,
    "contacts": 1
  }
}

Фактический результат

HTTP 200

{
    "status": "Сохранили объявление - (UUID объявления)"
}

Ожидаемый результат

Значение -100 НЕ должно считаться валидным, так как НЕ является допустимым значением цены.


Обоснование приоритета

Ошибка позволяет создавать объявления с некорректной ценой, что нарушает бизнес-логику сервиса.




Кейс_4 — Некорректное сообщение об ошибке при передаче пустого тела запроса

Приоритет: Medium

Описание

При передаче пустого тела в POST /api/1/item сервер возвращает сообщение, не соответствующее причине ошибки.

Шаги воспроизведения

1. Отправить POST /api/1/item с пустым телом:


Фактический результат

HTTP код 400
Ответ:

{
    "result": {
        "message": "",
        "messages": {}
    },
    "status": "не передан объект - объявление"
}

Ожидаемый результат

Ответ должен содержать информативное сообщение о причине ошибки, например:

«Тело запроса не может быть пустым»


Обоснование приоритета:

Сообщение не отражает реальную причину ошибки, что усложняет отладку и использование API.



Кейс_5 — Дублирование часовой зоны в поле createdAt

Приоритет: Medium

Описание

В ответах API поле `createdAt` содержит дублированную метку часового пояса, например: "2025-12-28 18:44:24.948154 +0300 +0300". Такой формат нестандартен и может не парситься клиентами.

Шаги воспроизведения

1. Создать объявление: POST /api/1/item с валидным телом или выполнить GET /api/1/{sellerId}/item для получения списка.
2. Посмотреть значение поля `createdAt` в ответе.

Фактический результат

Поле `createdAt` имеет вид: "2025-12-28 18:44:24.948154 +0300 +0300".

Ожидаемый результат

Поле `createdAt` должно быть в стандарте ISO-8601/RFC3339, например: "2025-12-28T18:44:24.948154+03:00" или в UTC "2025-12-28T15:44:24.948154Z".

Обоснование приоритета

Некорректный формат даты приводит к ошибкам парсинга у клиентов и усложняет автоматическую обработку времён.



Кейс_6 — API принимает запросы с лишними полями

Приоритет: Medium

Описание

При создании объявления через POST /api/1/item API принимает запросы с лишними полями, которые не описаны в спецификации. Это может привести к неконтролируемому поведению и усложняет валидацию данных.

Шаги воспроизведения

1. Отправить POST /api/1/item с телом:
{
  "sellerId": 123456,
  "name": "Test item",
  "price": 100,
  "color": "red",
  "extra_field": 123,
  "statistics": {
    "likes": 1,
    "viewCount": 1,
    "contacts": 1
  }
}

Фактический результат

HTTP код 200

{
    "status": "Сохранили объявление - <UUID объявления>"
}

Ожидаемый результат

HTTP код 400

Сообщение об ошибке в теле ответа, указывающее на наличие недопустимых полей (color, extra_field).

Обоснование приоритета

Отсутствие строгой валидации входных данных может привести к проблемам с безопасностью и неожиданному поведению API.



Кейс_7 — При удалении объявления возвращается некорректный HTTP статус

Приоритет: Low

Описание
При удалении объявления через DELETE /api/2/item/{id} сервер возвращает HTTP 200 вместо более подходящего HTTP 204 No Content.

Шаги воспроизведения

1. Создать объявление через POST /api/1/item.
2. Удалить объявление через DELETE /api/2/item/{id}.
Фактический результат
HTTP 200

Ожидаемый результат
HTTP 204 No Content

Обоснование приоритета
Использование стандарта HTTP улучшает совместимость и понимание API клиентами.


Кейс_8 — Некорректная обработка несуществующего объявления при удалении
Приоритет: Medium

Описание:  
При попытке удалить несуществующее объявление через DELETE /api/2/item/{id} сервер возвращает некорректный HTTP статус и сообщение об ошибке.

Шаги воспроизведения:
1. Отправить DELETE /api/2/item/{UUID несуществующего объявления}

ФР:
- HTTP код 404
- Сообщение об ошибке в теле ответа:
{
    "result": {
        "message": "",
        "messages": null
    },
    "status": "500"
}
ОР:
- HTTP код 404
- Сообщение об ошибке в теле ответа:
{
    "result": {
        "message": "item (UUID) not found",
        "messages": null
    },
    "status": "404"
}